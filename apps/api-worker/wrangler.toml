name = "compliance-api-worker"
main = "src/index.ts"
compatibility_date = "2026-02-15"
workers_dev = true

[vars]
ENV_NAME = "dev"

[[r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "compliance-docs-dev"

[[kv_namespaces]]
binding = "CACHE_KV"
id = "307a6a51500c44549d6eaec2a1a81188"

[[d1_databases]]
binding = "DB"
database_name = "compliance-dev"
database_id = "11f10559-222b-493c-bb74-a28b247cf273"

[[vectorize]]
binding = "VECTORIZE_INDEX"
index_name = "compliance-dev-index"

[[queues.producers]]
binding = "INGEST_QUEUE"
queue = "compliance-ingest-dev"

[[durable_objects.bindings]]
name = "RATE_LIMITER_DO"
class_name = "RateLimiter"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["RateLimiter"]

[env.staging.vars]
ENV_NAME = "staging"

[[env.staging.r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "compliance-docs-staging"

[[env.staging.kv_namespaces]]
binding = "CACHE_KV"
id = "f5ebdbf8d962494194fb3d84cb2a586b"

[[env.staging.d1_databases]]
binding = "DB"
database_name = "compliance-staging"
database_id = "0973e44e-1cad-4861-a552-3c07063b6537"

[[env.staging.vectorize]]
binding = "VECTORIZE_INDEX"
index_name = "compliance-staging-index"

[[env.staging.queues.producers]]
binding = "INGEST_QUEUE"
queue = "compliance-ingest-staging"

[[env.staging.durable_objects.bindings]]
name = "RATE_LIMITER_DO"
class_name = "RateLimiter"

[env.prod.vars]
ENV_NAME = "prod"

[[env.prod.r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "compliance-docs-prod"

[[env.prod.kv_namespaces]]
binding = "CACHE_KV"
id = "03da6132ed65466680651ac191dfaa4b"

[[env.prod.d1_databases]]
binding = "DB"
database_name = "compliance-prod"
database_id = "868eb001-dea3-4b7a-86ff-f5a797f8d7db"

[[env.prod.vectorize]]
binding = "VECTORIZE_INDEX"
index_name = "compliance-prod-index"

[[env.prod.queues.producers]]
binding = "INGEST_QUEUE"
queue = "compliance-ingest-prod"

[[env.prod.durable_objects.bindings]]
name = "RATE_LIMITER_DO"
class_name = "RateLimiter"
